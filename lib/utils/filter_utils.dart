import 'dart:ui' as ui;
import 'package:flutter/material.dart';

class FilterUtils {
  // 필터별 ColorMatrix 정의
  static Map<String, List<double>> filterMatrices = {
    // 음식 카테고리
    '카페 무드': [
      1.3, 0.2, 0.1, 0.0, 15,    // 따뜻한 조명 + 비네팅
      0.1, 1.1, 0.05, 0.0, 10,   // 자연스러운 초록
      0.05, 0.1, 0.7, 0.0, 5,    // 파랑 억제로 따뜻함 강화
      0.0, 0.0, 0.0, 1.0, 0.0
    ],
    '홈메이드 감성': [
      1.2, 0.25, 0.15, 0.0, 20,  // 필름 느낌의 따뜻한 빨강
      0.15, 0.85, 0.1, 0.0, 15,  // 페이드된 초록
      0.1, 0.15, 0.65, 0.0, 10,  // 세피아 톤
      0.0, 0.0, 0.0, 1.0, 0.0
    ],
    '소프트 파스텔': [
      0.95, 0.1, 0.1, 0.0, 25,   // 부드러운 빨강
      0.1, 0.95, 0.1, 0.0, 20,   // 부드러운 초록
      0.1, 0.1, 0.95, 0.0, 15,   // 부드러운 파랑
      0.0, 0.0, 0.0, 1.0, 0.0
    ],
    '비비드 컬러': [
      1.4, 0.0, 0.0, 0.0, 5,     // 강렬한 빨강
      0.0, 1.4, 0.0, 0.0, 5,     // 강렬한 초록
      0.0, 0.0, 1.4, 0.0, 5,     // 강렬한 파랑
      0.0, 0.0, 0.0, 1.0, 0.0
    ],
    '미니멀 그레이': [
      0.6, 0.6, 0.6, 0.0, 10,    // 그레이스케일
      0.3, 0.3, 0.3, 0.0, 10,
      0.1, 0.1, 0.1, 0.0, 10,
      0.0, 0.0, 0.0, 1.0, 0.0
    ],
    // 매장 카테고리
    '모던 블랙': [
      0.85, 0.0, 0.05, 0.0, -15, // 세련된 다크 톤
      0.0, 0.85, 0.05, 0.0, -15, // 쿨톤 강화
      0.05, 0.05, 1.1, 0.0, -10, // 파랑 강조
      0.0, 0.0, 0.0, 1.0, 0.0
    ],
    '웜 우드': [
      1.25, 0.2, 0.1, 0.0, 10,   // 따뜻한 브라운
      0.15, 1.0, 0.1, 0.0, 5,    // 자연스러운 초록
      0.05, 0.1, 0.7, 0.0, 0,    // 파랑 억제
      0.0, 0.0, 0.0, 1.0, 0.0
    ],
    '미니멀': [
      1.15, 0.05, 0.05, 0.0, 20, // 깔끔한 빨강
      0.05, 1.15, 0.05, 0.0, 20, // 깔끔한 초록
      0.05, 0.05, 1.15, 0.0, 20, // 깔끔한 파랑
      0.0, 0.0, 0.0, 1.0, 0.0
    ],
    // 제품 카테고리
    '럭셔리': [
      1.15, 0.0, 0.0, 0.0, -5,   // 고급스러운 빨강
      0.0, 1.15, 0.0, 0.0, -5,   // 고급스러운 초록
      0.0, 0.0, 1.25, 0.0, -10,  // 쿨톤 강조
      0.0, 0.0, 0.0, 1.0, 0.0
    ],
    '클린': [
      0.95, 0.0, 0.0, 0.0, 25,   // 하이키 화이트
      0.0, 0.95, 0.0, 0.0, 25,   // 깔끔한 초록
      0.0, 0.0, 1.0, 0.0, -5,    // 약간의 쿨톤
      0.0, 0.0, 0.0, 1.0, 0.0
    ],
    // 패션 카테고리
    '트렌디': [
      1.25, 0.1, 0.1, 0.0, 8,    // 생동감 있는 빨강
      0.05, 1.2, 0.05, 0.0, 8,   // 생동감 있는 초록
      0.1, 0.1, 1.35, 0.0, 12,   // 강조된 파랑
      0.0, 0.0, 0.0, 1.0, 0.0
    ],
    '빈티지': [
      1.1, 0.3, 0.2, 0.0, 5,     // 빈티지 레드
      0.2, 0.8, 0.1, 0.0, 0,     // 페이드된 그린
      0.1, 0.2, 0.6, 0.0, 15,    // 세피아 톤
      0.0, 0.0, 0.0, 1.0, 0.0
    ],
  };

  // 필터별 ColorMatrix 가져오기
  static List<double> getMatrixForFilter(String filterName) {
    print('필터 매트릭스 요청: $filterName'); // 디버그용
    final matrix = filterMatrices[filterName] ?? [
      1.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 1.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 1.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 1.0, 0.0,
    ];
    print('적용된 매트릭스: $matrix'); // 디버그용
    return matrix;
  }

  // 필터별 조정값 가져오기
  static Map<String, int> getFilterValues(String filterName) {
    switch (filterName) {
      case '카페 무드':
        return {'밝기': 15, '대비': 10, '따뜻함': 10};
      case '홈메이드 감성':
        return {'밝기': 20, '대비': 5, '따뜻함': 15};
      case '소프트 파스텔':
        return {'밝기': 25, '대비': 0, '따뜻함': 15};
      case '비비드 컬러':
        return {'밝기': 5, '대비': 30, '따뜻함': 5};
      case '미니멀 그레이':
        return {'밝기': 10, '대비': -50, '따뜻함': 10};
      case '모던 블랙':
        return {'밝기': -15, '대비': 20, '따뜻함': -10};
      case '웜 우드':
        return {'밝기': 10, '대비': 0, '따뜻함': 15};
      case '미니멀':
        return {'밝기': 20, '대비': -10, '따뜻함': 0};
      case '럭셔리':
        return {'밝기': -5, '대비': 10, '따뜻함': -10};
      case '클린':
        return {'밝기': 15, '대비': -5, '따뜻함': -5};
      case '트렌디':
        return {'밝기': 8, '대비': 8, '따뜻함': 12};
      case '빈티지':
        return {'밝기': 5, '대비': -10, '따뜻함': 15};
      default:
        return {'밝기': 0, '대비': 0, '따뜻함': 0};
    }
  }

  // 필터 이름으로 기본값 가져오기
  static Map<String, double> getFilterPreset(String filterName) {
    final values = getFilterValues(filterName);
    return {
      'brightness': values['밝기']! / 100.0,
      'contrast': values['대비']! / 100.0,
      'warmth': values['따뜻함']! / 100.0,
    };
  }

  // 조정값으로 ColorMatrix 생성
  static List<double> createAdjustmentMatrix({
    required double brightness,
    required double contrast,
    required double saturation,
    required double warmth,
  }) {
    print('매트릭스 생성: 밝기=$brightness, 대비=$contrast, 채도=$saturation, 따뜻함=$warmth');
    
    // 값들을 적절한 범위로 변환
    double b = brightness / 100.0; // -1.0 ~ 1.0
    double c = 1.0 + (contrast / 100.0); // 0.0 ~ 2.0
    double s = 1.0 + (saturation / 100.0); // 0.0 ~ 2.0
    double w = warmth / 100.0; // -1.0 ~ 1.0
    
    // ColorMatrix 생성 (4x5 형태)
    return [
      c * s + w * 0.1, w * 0.05, -w * 0.05, 0.0, b * 255,  // Red
      w * 0.05, c * s, -w * 0.1, 0.0, b * 255,             // Green  
      -w * 0.1, -w * 0.05, c * s + w * 0.15, 0.0, b * 255, // Blue
      0.0, 0.0, 0.0, 1.0, 0.0,                             // Alpha
    ];
  }
} 